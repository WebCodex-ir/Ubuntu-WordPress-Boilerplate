# 🚀 اسکریپت نصب سرور وردپرس حرفه‌ای (نسخه نهایی)

این اسکریپت برای راه‌اندازی سریع و خودکار یک سرور وردپرس کامل، بهینه و امن بر روی سیستم‌عامل **Ubuntu 24.04 LTS** طراحی شده است. این پروژه نتیجه یک پروسه دیباگ جامع و یادگیری عمیق برای رسیدن به یک راه حل پایدار و قابل اعتماد است.

## ✨ ویژگی‌ها و تکنولوژی‌های نصب شده

* ✅ **وب سرور:** **Apache2** (برای حداکثر پایداری و سازگاری)
* ✅ **دیتابیس:** **MariaDB** (جایگزین مدرن و بهینه MySQL)
* ✅ **محیط اجرا:** **PHP** (آخرین نسخه پایدار به همراه تمام افزونه‌های ضروری)
* ✅ **کش سرور:** **Redis** (برای کش آبجکت و کاهش فشار روی دیتابیس)
* ✅ **امنیت SSL:** گواهی رایگان **Let's Encrypt** با نصب و تمدید کاملاً خودکار.
* ✅ **فشرده‌سازی:** **Brotli** (الگوریتم فشرده‌سازی مدرن گوگل برای سرعت بالاتر)
* ✅ **پروتکل وب:** **HTTP/2** (برای بارگذاری موازی و سریع‌تر منابع سایت)
* ✅ **فایروال برنامه وب (WAF):** **ModSecurity** به همراه قوانین OWASP برای محافظت در برابر حملات وب.
* ✅ **امنیت شبکه:** فایروال **UFW** و سیستم ضدحمله **Fail2Ban**.
* ✅ **انتقال فایل امن:** **SFTP** به صورت پیش‌فرض با دسترسی SSH فعال است.
* ✅ **کنترل خطا:** اسکریپت در هر مرحله موفقیت را بررسی کرده و در صورت بروز مشکل با پیغام واضح متوقف می‌شود.

## 📋 پیش‌نیازها

1.  یک سرور با سیستم‌عامل **Ubuntu 24.04 LTS تازه نصب شده**.
2.  یک **نام دامنه** که رکورد A آن به آدرس IP سرور شما اشاره می‌کند.
3.  دسترسی به سرور از طریق **SSH** با کاربر `root`.

## 🚀 نحوه استفاده

1.  با `root` به سرور خود SSH بزنید.
2.  این مخزن را روی سرور خود Clone کنید:
    ```bash
    git clone https://github.com/WebCodex-ir/Ubuntu-WordPress-Boilerplate.git
    cd Ubuntu-WordPress-Boilerplate
    ```
3.  به اسکریپت دسترسی اجرایی بدهید:
    ```bash
    chmod +x install.sh
    ```
4.  اسکریپت را اجرا کنید:
    ```bash
    sudo ./install.sh
    ```
اسکریپت از شما اطلاعات لازم را می‌پرسد و بقیه کارها را به صورت خودکار انجام می‌دهد.

## ⚙️ پس از نصب

پس از اتمام موفقیت‌آمیز اسکریپت، تمام اطلاعات مهم (شامل رمز ریشه دیتابیس) به شما نمایش داده خواهد شد.

### **نصب وردپرس جدید**
* به آدرس `https://your-domain.com` بروید و مراحل نصب ۵ دقیقه‌ای وردپرس را تکمیل کنید.

### **انتقال سایت قدیمی**
برای انتقال سایت قدیمی خود، مراحل زیر را دنبال کنید:

#### 📁 **اتصال با WinSCP (برای فایل‌ها)**
- **پروتکل:** `SFTP`
- **آدرس میزبان:** IP سرور شما
- **پورت:** `22`
- **نام کاربری:** `root`
- **رمز عبور:** رمز SSH سرور شما

پس از اتصال، به مسیر `/var/www/vhosts/your-domain.com` بروید، تمام فایل‌های موجود را پاک کرده و فایل‌های سایت خود را آپلود کنید.

#### 🐬 **اتصال با Navicat (برای دیتابیس)**
- **نوع اتصال:** `MySQL / MariaDB`
- **آدرس میزبان:** IP سرور شما
- **پورت:** `3306`
- **نام کاربری:** `root`
- **رمز عبور:** **رمز ریشه MariaDB** که در انتهای اجرای اسکریپت به شما نمایش داده شد.

پس از اتصال، دیتابیسی که ساخته‌اید را پیدا کرده، جداول آن را خالی کنید و فایل `.sql` بکاپ خود را Import نمایید.

#### 🛡️ **نکته امنیتی بسیار مهم برای Navicat**
استفاده دائمی از کاربر `root` برای اتصال ریموت خطرناک است. پس از اولین اتصال، قویاً توصیه می‌شود یک کاربر جدید مخصوص IP ثابت خود بسازید. در Navicat یک کوئری جدید با دستورات زیر اجرا کنید:
```sql
CREATE USER 'your_user'@'YOUR_STATIC_IP' IDENTIFIED BY 'your_strong_password';
GRANT ALL PRIVILEGES ON your_database_name.* TO 'your_user'@'YOUR_STATIC_IP';
FLUSH PRIVILEGES;
```
سپس یک کانکشن جدید در Navicat با این اطلاعات بسازید.

#### **اصلاح دسترسی‌ها**
بعد از انتقال فایل‌ها، این دستورات را در سرور اجرا کنید تا دسترسی‌ها صحیح شوند:
```bash
sudo chown -R www-data:www-data /var/www/vhosts/your-domain.com
sudo find /var/www/vhosts/your-domain.com -type d -exec chmod 755 {} \;
sudo find /var/www/vhosts/your-domain.com -type f -exec chmod 644 {} \;
```

#### **فعال‌سازی Redis**
پس از انتقال کامل سایت، در پیشخوان وردپرس یک افزونه کش مانند **LiteSpeed Cache** یا **W3 Total Cache** نصب کرده و در بخش Object Cache، آن را به Redis متصل کنید.

## ➕ افزودن سایت یا ساب‌دامین جدید

بعد از راه‌اندازی اولیه سرور، می‌توانید به راحتی دامنه‌ها یا ساب‌دامین‌های جدیدی برای سایت‌های وردپرسی دیگر به همین سرور اضافه کنید. اسکریپت `add-site.sh` این فرآیند را کاملاً خودکار می‌کند.

### نحوه استفاده

1.  مطمئن شوید که رکورد A دامنه یا ساب‌دامین جدید شما به IP سرور اشاره می‌کند و حداقل چند دقیقه از تنظیم آن گذشته است.
2.  اسکریپت `add-site.sh` را روی سرور خود آپلود کنید (اگر از قبل آن را clone نکرده‌اید).
3.  به آن دسترسی اجرایی بدهید:
    ```bash
    chmod +x add-site.sh
    ```
4.  اسکریپت را اجرا کنید:
    ```bash
    sudo ./add-site.sh
    ```
اسکریپت از شما اطلاعات سایت جدید را پرسیده و به صورت هوشمند رمز ریشه دیتابیس را از لاگ‌های نصب قبلی پیدا کرده و تمام مراحل ساخت دیتابیس، نصب وردپرس و گرفتن SSL را برای سایت جدید انجام می‌دهد.

---
ساخته شده با ❤️ و تجربه فراوان.
